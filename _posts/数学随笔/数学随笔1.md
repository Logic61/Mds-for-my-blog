---
title: 数学随笔1：添行与合成大矩阵
date: 2025/1/5
categories: ['数学随笔']
tags: ['数学随笔', '数学']
pinned: 10
---
主要介绍构造矩阵的想法，最后随手记录了Vandermonde行列式的推导

<!-- more -->
---

# 构造矩阵联系起各种要素，从而进一步处理

#### 例如，在行列式计算中，我们有所谓添行。

##### *除了对角元以外都一样的行列式求解



<p>
$$
\begin{pmatrix} a & t & \cdots & t \ t & a & \cdots & t \ \vdots & \vdots & \ddots & \vdots \ t & t & \cdots & a \end{pmatrix}
$$
</p>



的行列式求解，一种是我们可以直接做行列变换，还有一种操作是构造一个更大的矩阵：



<p>
$$
\left(

\begin{array}{c|cccc} 1 & t & t & \cdots & t\ \hline 0 & a & t & \cdots & t \ 0 & t & a & \cdots & t \ \vdots & \vdots & \vdots & \ddots & \vdots \ 0 & t & t & \cdots & a \end{array}

\right)
$$
</p>



此时行列式可以看做对第一列展开，仍然不变，这时执行消元，看起来简单的多。



<p>
$$
\begin{pmatrix} 1 & t & t & \cdots & t \ -1 & a-t & 0 & \cdots & 0 \ -1 & 0 & a-t & \cdots & 0 \ \vdots & \vdots & \vdots & \ddots & \vdots \ -1 & 0 & 0 & \cdots & a-t \end{pmatrix}
$$
</p>



随后消去第一行或第一列即可

##### *添行列+代数余子式

（pku25秋线代期中）已知 $|A| = 5, a_{11} = 2$ ， $A_{ij}$ 为元素 $a_{ij}$ 的代数余子式。



<p>
$$
\text{求：}

\begin{vmatrix} A_{22} & A_{23} & \cdots & A_{2n} \ A_{32} & A_{33} & \cdots & A_{3n} \ \vdots & \vdots & \ddots & \vdots \ A_{n2} & A_{n3} & \cdots & A_{nn} \end{vmatrix}
$$
</p>



我们容易想到余子式的正交性，添行：



<p>
$$
\begin{vmatrix} A_{11} & A_{12} & A_{13} & \cdots & A_{1n} \ 0 & A_{22} & A_{23} & \cdots & A_{2n} \ 0 & A_{32} & A_{33} & \cdots & A_{3n} \ \vdots & \vdots & \vdots & \ddots & \vdots \ 0 & A_{n2} & A_{n3} & \cdots & A_{nn} \end{vmatrix}
$$
</p>



这时利用经典的 $det(AB) = det(A) \cdot det(B)$ ,我们左乘原来的矩阵的转置：



<p>
$$
\begin{pmatrix} a_{11} & a_{21} & a_{31} & \cdots & a_{n1} \ a_{12} & a_{22} & a_{32} & \cdots & a_{n2} \ a_{13} & a_{23} & a_{33} & \cdots & a_{n3} \ \vdots & \vdots & \vdots & \ddots & \vdots \ a_{1n} & a_{2n} & a_{3n} & \cdots & a_{nn} \end{pmatrix}

\begin{pmatrix} A_{11} & A_{12} & \cdots & A_{1n} \ 0 & A_{22} & \cdots & A_{2n} \ \vdots & \vdots & \ddots & \vdots \ 0 & A_{n2} & \cdots & A_{nn} \end{pmatrix}
$$
</p>



利用正交性也就有：



<p>
$$
\begin{pmatrix} a_{11}A_{11} & a_{11}A_{12} + \dots & \cdots & a_{11}A_{1n} + \dots \ 0 & |A| & \cdots & 0 \ \vdots & \vdots & \ddots & \vdots \ 0 & 0 & \cdots & |A| \end{pmatrix}
$$
</p>



从而



<p>
$$
a_{11}A_{11}|A|^{n-1} = |A| \cdot A_{11} \cdot \det(\text{子矩阵}) \implies \text{子式} = |A|^{n-2} \cdot a_{11}
$$
</p>



#### 在矩阵操作中，也常有合成大矩阵

##### *基础准备：分块矩阵的秩与行列式

根据Laplace展开，我们知道：



<p>
$$
\det

\begin{pmatrix} A & O \ C & B \end{pmatrix}

= \det(A) \det(B)
$$
</p>



同时，我们还有：



<p>
$$
rank

\begin{pmatrix} A & O \ O & B \end{pmatrix}

= rank(A)+rank(B)
$$
</p>



可以通过做行列变化得到，以及：



<p>
$$
rank

\begin{pmatrix} A & O \ C & B \end{pmatrix}

\ge rank(A)+rank(B)
$$
</p>



##### *Frobenius不等式的证明



<p>
$$
\text{rank}(ABC) + \text{rank}(B) \ge \text{rank}(AB) + \text{rank}(BC)
$$
</p>



我们构造如下的 $2 \times 2$ 分块矩阵 $M$ ：



<p>
$$
M =

\begin{pmatrix} AB & O \ B & BC \end{pmatrix}
$$
</p>



这里不难看出， $rank(M)>=rank(AB)+rank(BC)$ ，如果构造左下角是 $O$ ，虽然直接等于了，但我们没什么操作空间。这时我们行列变换消去左上角和右下角：



<p>
$$
\begin{pmatrix} AB & O \ B & BC \end{pmatrix}

\xrightarrow{R_1 - AR_2}

\begin{pmatrix} O & -ABC \ B & BC \end{pmatrix}

\xrightarrow{C_2 - C_1C}

\begin{pmatrix} O & -ABC \ B & O \end{pmatrix}
$$
</p>



那么也就得到了想要的结论

###### *Sylvester不等式

虽然和主题无关，但只要将 $B$ 取为 $I$ ，我们也就得到了Sylvester不等式：



<p>
$$
\text{rank}(AC) + \text{rank}(I) \ge \text{rank}(A) + \text{rank}(C)
$$
</p>



即：



<p>
$$
\text{rank}(AC) \ge \text{rank}(A) + \text{rank}(C) - n
$$
</p>



这个不等式在秩相关问题可以大展身手。例如证明 $\text{rank}(A) = n-1$ 时伴随矩阵秩1：

* 因为 $\text{rank}(A) = n-1$ ，所以存在一个 $n-1$ 阶子式不为 $0$ ，故 $A^* \neq O$ ，得 $\text{rank}(A^*) \ge 1$ 。

* 此时 $\det(A) = 0$ ，代入定义式得 $A \cdot A^* = O$ 。

* 构造秩的不等式：

根据 $\text{rank}(AB) = 0 \implies \text{rank}(A) + \text{rank}(B) \le n$ ：



<p>
$$
\text{rank}(A) + \text{rank}(A^*) \le n
$$
</p>





<p>
$$
(n-1) + \text{rank}(A^*) \le n \implies \text{rank}(A^*) \le 1
$$
</p>



##### *证明 $\det(I+AB) = \det(I+BA)$ 类似地我们构造：



<p>
$$
\begin{pmatrix} I & A \ O & I+BA \end{pmatrix}
$$
</p>



然后进行消元操作：



<p>
$$
\begin{pmatrix} I & A \ O & I+BA \end{pmatrix}

\xrightarrow{R_2 - BR_1}

\begin{pmatrix} I & A \ -B & I \end{pmatrix}

\xrightarrow{R_1 + AR_2}

\begin{pmatrix} I-AB & O \ B & I \end{pmatrix}
$$
</p>



也就证明了结论

##### * $AB$ 与 $BA$ 特征多项式的关系

设 $A \in \mathbb{F}^{m \times n}, B \in \mathbb{F}^{n \times m}$ ，则：



<p>
$$
\lambda^n \det(\lambda I_m - AB) = \lambda^m \det(\lambda I_n - BA)
$$
</p>



如法炮制，构造矩阵：



<p>
$$
\begin{pmatrix} \lambda I_m - AB & O \ B & I_n \end{pmatrix}
$$
</p>



消元：



<p>
$$
\begin{pmatrix} \lambda I_m - AB & O \ B & I_n \end{pmatrix}

\xrightarrow{R_1 + AR_2}

\begin{pmatrix} \lambda I_m & A \ B & I_n \end{pmatrix}

\xrightarrow{R_2 - \frac{1}{\lambda}BR_2}

\begin{pmatrix} \lambda I_m & A \ O & I_n - \frac{1}{\lambda}B A \end{pmatrix}
$$
</p>



从而



<p>
$$
\det(\lambda I_m - AB) = \lambda^{m-n} \det(\lambda I_n - BA)
$$
</p>



这显然与结论等价。

##### *Binet-Cauchy公式的证明

具体公式为：若 $A$ 是 $n \times m$ 矩阵， $B$ 是 $m \times n$ 矩阵（ $n \le m$ ），则：



<p>
$$
\det(AB) = \sum_{1 \le j_1 < j_2 < \dots < j_n \le m} \det(A_{j_1, \dots, j_n}) \det(B^{j_1, \dots, j_n})
$$
</p>



其中 $A_{j_1, \dots, j_n}$ 是取 $A$ 的第 $j_1, \dots, j_n$ 列构成的方阵， $B^{j_1, \dots, j_n}$ 是取 $B$ 的第 $j_1, \dots, j_n$ 行构成的方阵。

证明：

我们通过构造一个 $(n+m) \times (n+m)$ 的分块矩阵 $M$ 来实现：



<p>
$$
M =

\begin{pmatrix} I_m & B \ -A & 0 \end{pmatrix}
$$
</p>



显然 $M$ 的行列式也就是 $det(AB)$ ，利用 Laplace 展开

直接对 $M$ 的前 $m$ 行进行 Laplace 展开。

由于左上角是 $I_m$ ，每一个不为零的展开项都对应着 $A$ 的一个 $n$ 阶子式与 $B$ 的一个 $n$ 阶子式的乘积。由于 $I_m$ 是单位阵，选取的行和列匹配时才非零，最终会自然产生：



<p>
$$
\sum_{1 \le j_1 < j_2 < \dots < j_n \le m} \det(A_{j_1, \dots, j_n}) \det(B^{j_1, \dots, j_n})
$$
</p>



结合一的结果，结论得证。

### 总结

大概如是，使用情景大概为：

* **乘积顺序交换：** 涉及到 $AB$ 与 $BA$ 的对称性。

* **秩的不等式：** 出现三个或更多矩阵连乘（如 Frobenius）。

* **行列式中绝大多数元素有规律：** 构造 $n+1$ 阶矩阵引入辅助变量。

# Vandermonde行列式

通过多项式因式分解确定行列式形式

##### Vandermonde行列式

设 $n$ 阶范德蒙德行列式为：



<p>
$$
V_n =

\begin{vmatrix} 1 & 1 & \cdots & 1 \ x_1 & x_2 & \cdots & x_n \ x_1^2 & x_2^2 & \cdots & x_n^2 \ \vdots & \vdots & \ddots & \vdots \ x_1^{n-1} & x_2^{n-1} & \cdots & x_n^{n-1} \end{vmatrix}
$$
</p>



我们要证明： $V_n = \prod_{1 \le i < j \le n} (x_j - x_i)$ 。
当 $n=2$ 时：



<p>
$$
V_2 =

\begin{vmatrix} 1 & 1 \ x_1 & x_2 \end{vmatrix}

= x_2 - x_1
$$
</p>



公式成立。
假设公式对于 $n-1$ 阶范德蒙德行列式成立。
对最后一列展开，显然是最高次为 $x_n^{n-1}$ 的多项式，最高次系数根据归纳假设为 $V_n = \prod_{1 \le i < j \le n-1} (x_j - x_i)$ ，注意到 $x_n$ 等于 $\forall i < n, i \in \mathbb{N}^+$ 的时候多项式为 $0$ ，也就是说可以因式分解为：



<p>
$$
\prod_{1 \le i \le n-1}(x_n - x_i)\prod_{1 \le i < j \le n-1} (x_j - x_i)
$$
</p>



合并即可得到结论。

##### Cauchy行列式

证明 $n$ 阶 Cauchy 行列式：（由AI给出，懒得打了）



<p>
$$
C_n =

\begin{vmatrix} \frac{1}{a_1+b_1} & \cdots & \frac{1}{a_1+b_n} \ \vdots & \ddots & \vdots \ \frac{1}{a_n+b_1} & \cdots & \frac{1}{a_n+b_n} \end{vmatrix}

= \frac{\prod_{1 \le i < j \le n} (a_j - a_i)(b_j - b_i)}{\prod_{i=1}^n \prod_{j=1}^n (a_i + b_j)}
$$
</p>



###### 第一步：基础步骤

当 $n=1$ 时：

* 左边 $= \frac{1}{a_1+b_1}$ * 右边：分子为空积（定义为 $1$ ），分母为 $a_1+b_1$ 。

* 等式成立。

###### 第二步：归纳假设与行列式变换

假设对于 $n-1$ 阶行列式公式成立。对于 $n$ 阶行列式，我们要利用初等变换将其降阶。

1. 消去第一行以外的元素：

对行列式进行列变换。用第 $j$ 列减去第 $n$ 列 ($j=1, 2, \dots, n-1$)：



<p>
$$
c_{ij}' = \frac{1}{a_i+b_j} - \frac{1}{a_i+b_n} = \frac{b_n - b_j}{(a_i+b_j)(a_i+b_n)}
$$
</p>



**2\. 提取公因子：**

* 从每一列 $j$ ($j < n$) 提取公因子 $(b_n - b_j)$ 。

* 从每一行 $i$ 提取公因子 $\frac{1}{a_i+b_n}$ 。

* 从每一列 $j$ ($j < n$) 提取公因子 $\frac{1}{a_n+b_j}$ （为了让最后一行变简单）。

经过一系列复杂的提取（或直接对每一项进行代数变形），行列式可以转化为：



<p>
$$
C_n = \frac{\prod_{j=1}^{n-1}(b_n-b_j) \cdot \prod_{i=1}^{n-1}(a_n-a_i)}{\prod_{i=1}^n(a_i+b_n) \cdot \prod_{j=1}^{n-1}(a_n+b_j)} \cdot C_{n-1}
$$
</p>



###### 第三步：递推求解

将归纳假设中的 $C_{n-1}$ 代入上述递推式：

1. **分子部分** ： $C_{n-1}$ 贡献了 $1 \le i < j \le n-1$ 的差积，递推项贡献了包含 $n$ 的差积（如 $a_n-a_i$ 和 $b_n-b_j$ ）。合起来正好构成 $1 \le i < j \le n$ 的完整差积。

2. **分母部分** ： $C_{n-1}$ 贡献了前 $n-1$ 行列的所有组合，递推项正好补齐了第 $n$ 行和第 $n$ 列的所有组合 $(a_i+b_n)$ 和 $(a_n+b_j)$ 。

**结论** ：等式对 $n$ 阶成立。
