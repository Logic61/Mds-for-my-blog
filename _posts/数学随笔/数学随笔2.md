---
title: 数学随笔2：分块矩阵行列式与 Woodbury 矩阵恒等式相关
date: 2026/1/6
categories: ['数学随笔']
tags: ['数学随笔', '数学']
pinned: 10
---
作为一个整理而已，没有太多思想。

<!-- more -->
---

##### 分块矩阵的行列式

如果希望求解分块矩阵的行列式，我们通常也像正常行列式那样消元形成三角阵，那也就可以如此操作：



<p>
$$
\begin{pmatrix} A & B \ C & D \end{pmatrix}

\xrightarrow{R_1 - BD^{-1}R_2}

\begin{pmatrix} A-BD^{-1}C & O \ C & D \end{pmatrix}
$$
</p>



此时就可以得到



<p>
$$
\det(M) = \det(D) \cdot \det(A - BD^{-1}C)
$$
</p>



##### Woodbury 恒等式



<p>
$$
(A - BD^{-1}C)^{-1} = A^{-1} + A^{-1}B(D - CA^{-1}B)^{-1}CA^{-1}
$$
</p>



证明通过行列变换给出： 设 $M = \begin{pmatrix} A & B \ C & D \end{pmatrix}$ ，假设 $A$ 可逆。 首先我们可以进行行列变换：



<p>
$$
\begin{pmatrix} A & B \ C & D \end{pmatrix}

\xrightarrow{R_1 - BD^{-1}R_2}

\begin{pmatrix} A-BD^{-1}C & O \ C & D \end{pmatrix}
$$
</p>



这样就得到了左边出现的 $(A - BD^{-1}C)$ ，如何求逆呢？ 我们只要求出 $M$ 的逆，他的左上角即为 $A-BD^{-1}C$ 的逆了，那么就只是简单的消元，构造增广矩阵：



<p>
$$
\left(

\begin{array}{cc|cc} A & B & I & 0 \ C & D & 0 & I \end{array}

\right)
$$
</p>



第一行乘 $A^{-1}$ ：



<p>
$$
\left(

\begin{array}{cc|cc} I & A^{-1}B & A^{-1} & 0 \ C & D & 0 & I \end{array}

\right)
$$
</p>



消去左下角 $ C



<p>
$$
$ \left(

\begin{array}{cc|cc} I & A^{-1}B & A^{-1} & 0 \ 0 & D - CA^{-1}B & -CA^{-1} & I \end{array}

\right)
$$
</p>



记 $\Delta_A=D - CA^{-1}B$ ，然后乘上他的逆：



<p>
$$
\left(

\begin{array}{cc|cc} I & A^{-1}B & A^{-1} & 0 \ 0 & I & -\Delta_A^{-1}CA^{-1} & \Delta_A^{-1} \end{array}

\right)
$$
</p>



最后消掉右上角：



<p>
$$
\left(

\begin{array}{cc|cc} I & 0 & A^{-1} + A^{-1}B\Delta_A^{-1}CA^{-1} & -A^{-1}B\Delta_A^{-1} \ 0 & I & -\Delta_A^{-1}CA^{-1} & \Delta_A^{-1} \end{array}

\right)
$$
</p>



代入 $\Delta_A=D - CA^{-1}B$ 我们就得到：



<p>
$$
(A - BD^{-1}C)^{-1} = A^{-1} + A^{-1}B(D - CA^{-1}B)^{-1}CA^{-1}
$$
</p>



这就完成了证明。如果我们代入一些简单的值就会得到漂亮的等式：



<p>
$$
(I_n - BA)^{-1} = I_n + B(I_m - AB)^{-1}A
$$
</p>



把矩阵换成向量 $\alpha, \beta^T$ ：



<p>
$$
(I_n - \alpha \beta^T)^{-1} = I_n+\frac{\alpha \beta^T}{1-\beta^T \alpha} (\beta^T \alpha \neq 1)
$$
</p>



##### Schur 补

上面的 $D - CA^{-1}B$ 就被称为 Schur 补。

###### Schur 补与判别式

二次函数 $ax^2 + bx + c$ 。我们可以把它写成对称矩阵的二次型：



<p>
$$
f(x, 1) =

\begin{pmatrix} x & 1 \end{pmatrix}

\begin{pmatrix} a & b/2 \ b/2 & c \end{pmatrix}

\begin{pmatrix} x \ 1 \end{pmatrix}
$$
</p>



对于这个 $2 \times 2$ 矩阵，如果我们计算 $a$ 的 Schur 补：



<p>
$$
S = c - (b/2)a^{-1}(b/2) = c - \frac{b^2}{4a} = \frac{4ac - b^2}{4a}
$$
</p>



你会发现 Schur 补的分子部分正好就是判别式 $\Delta$ 的相反数。 这实际上可以推广到分块矩阵的正定性。 对于对称矩阵 $M = \begin{pmatrix} A & B \ B^T & C \end{pmatrix}$ ， $M \succ 0$ （正定）当且仅当： 1\. $A \succ 0$ 2\. $S = C - B^T A^{-1} B \succ 0$ 因为这实际上相当于我们做了一个合同变换把他变成了对角阵：



<p>
$$
M' =

\begin{pmatrix} A & O \ O & C-B^TA^{-1}B \end{pmatrix}
$$
</p>



从而保正定性，只要 $M'$ 正定就可知 $M$ 正定。

###### 正定加半正定行列式不变小

假设 $A, B$ 是两个复 $Hermitian$ 矩阵，其中 $A$ 正定， $B$ 半正定，那么有：



<p>
$$
\det(A+B) \ge \det(A)
$$
</p>



证明： 我们希望更直观地看到 $A+B$ 与 $A$ 的差别，利用 Schur 补：



<p>
$$
\det(A+B)=\det(A) \cdot \det(I+A^{-1}B)
$$
</p>



然后我们只需要证明：



<p>
$$
\det(I+A^{-1}B) \ge 1
$$
</p>



这时利用 $A$ 正定从而 $A^{-1}$ 正定（特征值全部大于 0），就可以拆分：



<p>
$$
\det(I+A^{-1/2} \cdot A^{-1/2} \cdot B)
$$
</p>



利用 $\det(I+AB) = \det(I+BA)$ ，把后两个矩阵看做一块，和第一个交换乘法顺序：



<p>
$$
\det(I+A^{-1/2}BA^{-1/2})
$$
</p>



这相当于对 $B$ 做合同变换，保特征值，可见 $A^{-1/2}BA^{-1/2}$ 半正定，显然这也对称，于是可以把它对角化：



<p>
$$
A^{-1/2}BA^{-1/2} = Q \Sigma Q^*
$$
</p>



那么 $\Sigma$ 特征值非负，从而原来那个行列式也就等于



<p>
$$
\det(I+ \Sigma) \ge \det(I) = 1
$$
</p>



也就完成了证明。
